{"version":3,"sources":["../src/module.js"],"names":["MetricsPanelCtrl","$","_","moment","d3","appEvents","MultistatPanelCtrl","$scope","$injector","panelDefaults","panel","elem","ctrl","defaults","events","on","onRender","bind","onDataReceived","onDataError","onInitEditMode","className","id","err","seriesList","data","displayStatusMessage","status","statusText","metricNames","sortDirections","aggregations","fontSizes","valuePositions","addEditorTab","cols","length","console","log","rows","type","i","columns","text","cols0","concat","render","emit","dateTimeCol","$title","closest","find","$maxDate","append","children","last","ShowDate","maxDate","dd","add","TZOffsetHours","DateFormat","toUpperCase","fromNow","show","format","hide","msg","html","labelCol","valueCol","sortCol","groupCol","DateTimeColName","LabelColName","ValueColName","SortColName","GroupColName","LabelNameFilter","regex","RegExp","matchingRows","label","match","push","Aggregate","oo","nest","key","d","rollup","entries","forEach","x","value","Object","values","assign","mean","Array","from","max","min","groupNameOffset","ShowGroupLabels","Number","GroupLabelFontSize","replace","groupedRows","GroupNameFilter","regexGroupRows","matchingGroups","groupName","groupSortString","GroupSortString","sort","a","b","aPos","search","bPos","localeCompare","SortDirection","ascending","y","comp","$container","h","height","w","width","buildDateHtml","horizontal","Horizontal","labelMargin","isNumeric","LabelMargin","lowSideMargin","LowSideMargin","highSideMargin","HighSideMargin","svg","select","selectAll","interrupt","barPadding","BarPadding","baseLineValue","BaseLineValue","minLineValue","MinLineValue","maxLineValue","MaxLineValue","highBarColor","HighBarColor","lowBarColor","LowBarColor","highLimitValue","HighLimitValue","HighLimitBarColor","HighLimitBarFlashColor","HighLimitBarFlashTimeout","recolorHighLimitBar","RecolorHighLimitBar","lowLimitValue","LowLimitValue","LowLimitBarColor","LowLimitBarFlashColor","LowLimitBarFlashTimeout","recolorLowLimitBar","RecolorLowLimitBar","flashHighLimitBar","FlashHighLimitBar","flashLowLimitBar","FlashLowLimitBar","showTooltips","ShowTooltips","TooltipDateFormat","ValueDecimals","OddRowColor","EvenRowColor","GroupCols","GroupGap","ScaleFactor","LabelColor","ValuePosition","minValue","maxValue","attr","style","tooltipShow","c","tooltipDiv","transition","duration","cc","toFixed","event","pageX","pageY","tooltipHide","scaleAndClipValue","val","plotGroupHorizontal","numRows","left","hh","dh","GroupLabelColor","labels","map","Math","random","toString","substr","labelScale","scaleBand","domain","rangeRound","paddingInner","paddingOuter","stripedata","range","stripeScale","oddeven","enter","step","gg","ShowValues","maxValueWidth","bandwidth","ValueFontSize","ValueColor","each","thisWidth","getComputedTextLength","ShowLabels","maxLabelWidth","labelAngle","LableAngle","LabelFontSize","OutOfRangeLabelColor","bbox","getBBox","s","sin","PI","cos","abs","valueScale","scaleLinear","nice","vLine","color","ShowBaseLine","BaseLineColor","ShowMaxLine","MaxLineColor","ShowMinLine","MinLineColor","ShowHighLimitLine","HighLimitLineColor","ShowLowLimitLine","LowLimitLineColor","classed","g","ggHighSide","call","axisTop","HighAxisColor","ggLowSide","axisBottom","LowAxisColor","gcols","dw","pointsPerRow","rr","floor","u","totalPoints","rowOverheadHeight","rowHeight","ceil","nn","ii","plotGroupVertical","maxValueHeight","thisHeight","maxLabelHeight","hLine","axisLeft","tickSizeInner","tickSizeOuter","ticks","axisRight","pointsPerCol","colOverheadWidth","colWidth","ww","pulseHigh","highFlashRects","_groups","highRepeat","active","pulseLow","lowFlashRects","lowRepeat","renderingCompleted","refresh","scope","attrs","templateUrl"],"mappings":"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","file":"module.js","sourcesContent":["/*jshint esversion: 6 */\nimport { MetricsPanelCtrl } from 'app/plugins/sdk';\nimport $ from 'jquery';\nimport 'jquery.flot';\nimport _ from 'lodash';\nimport moment from 'moment';\nimport \"./css/multistat-panel.css!\";\nimport d3 from './external/d3';\nimport {appEvents} from 'app/core/core';\n\n\n\n\nclass MultistatPanelCtrl extends MetricsPanelCtrl {\n\n    /** @ngInject */\n    constructor($scope, $injector) {\n        super($scope, $injector);\n\n        var panelDefaults = {\n\t\t\t\"BarPadding\": 10,\n\t\t\t\"BaseLineColor\": \"#ff0000\",\n\t\t\t\"BaseLineValue\": 0,\n\t\t\t\"DateTimeColName\": \"date\",\n\t\t\t\"DateFormat\": \"YYYY-MM-DD HH:mm:ss\",\n\t\t\t\"TooltipDateFormat\": \"YYYY-MM-DD HH:mm:ss\",\n\t\t\t\"FlashHighLimitBar\": false,\n\t\t\t\"FlashLowLimitBar\": false,\n\t\t\t\"HighAxisColor\": \"#ffffff\",\n\t\t\t\"HighBarColor\": \"rgb(120, 128, 0)\",\n\t\t\t\"HighLimitBarColor\": \"#ff0000\",\n\t\t\t\"HighLimitBarFlashColor\": \"#ffa500\",\n\t\t\t\"HighLimitBarFlashTimeout\": 1000,\n\t\t\t\"HighLimitLineColor\": \"#ff0000\",\n\t\t\t\"HighLimitValue\": 0.33,\n\t\t\t\"HighSideMargin\": 22,\n\t\t\t\"Horizontal\": false,\n\t\t\t\"LabelColName\": \"sensor\",\n\t\t\t\"LabelNameFilter\": \"\",\n\t\t\t\"LabelColor\": \"#ffffff\",\n\t\t\t\"OutOfRangeLabelColor\": \"#ffffff\",\n\t\t\t\"GroupLabelColor\": \"#ffffff\",\n\t\t\t\"LabelFontSize\": \"100%\",\n\t\t\t\"GroupLabelFontSize\": \"200%\",\n\t\t\t\"GroupGap\": 5,\n\t\t\t\"LabelMargin\": null,\n\t\t\t\"LowAxisColor\": \"#ffffff\",\n\t\t\t\"LowBarColor\": \"teal\",\n\t\t\t\"LowLimitBarColor\": \"#ff0000\",\n\t\t\t\"LowLimitBarFlashColor\": \"#ffa500\",\n\t\t\t\"LowLimitBarFlashTimeout\": 200,\n\t\t\t\"LowLimitLineColor\": \"#ff0000\",\n\t\t\t\"LowLimitValue\": null,\n\t\t\t\"LowSideMargin\": 22,\n\t\t\t\"MaxLineColor\": \"rgb(74, 232, 12)\",\n\t\t\t\"MaxLineValue\": 1,\n\t\t\t\"MinLineValue\": 0,\n\t\t\t\"RecolorHighLimitBar\": true,\n\t\t\t\"RecolorLowLimitBar\": false,\n\t\t\t\"ShowBaseLine\": true,\n\t\t\t\"ShowDate\": false,\n\t\t\t\"Aggregate\": \"last\",\n\t\t\t\"ShowHighLimitLine\": true,\n\t\t\t\"ShowLabels\": true,\n\t\t\t\"ShowGroupLabels\": true,\n\t\t\t\"ShowLeftAxis\": true,\n\t\t\t\"ShowLowLimitLine\": false,\n\t\t\t\"ShowMaxLine\": false,\n\t\t\t\"ShowMinLine\": true,\n\t\t\t\"ShowRightAxis\": true,\n\t\t\t\"ShowTooltips\": true,\n\t\t\t\"ShowValues\": true,\n\t\t\t\"SortColName\": \"value\",\n\t\t\t\"SortDirection\": \"ascending\",\n\t\t\t\"TZOffsetHours\": 0,\n\t\t\t\"ValueColName\": \"value\",\n\t\t\t\"ValueDecimals\": 2,\n\t\t\t\"ValueColor\": \"#ffffff\",\n\t\t\t\"ValueFontSize\": \"100%\",\n\t\t\t\"OddRowColor\": \"rgba(33, 33, 34, 0.92)\",\n\t\t\t\"EvenRowColor\": \"rgba(61, 61, 64, 0.78)\",\n\t\t\t\"GroupSortString\": \"\",\n\t\t\t\"GroupCols\": 0,\n\t\t\t\"GroupNameFilter\": \"\",\n\t\t\t\"ScaleFactor\": 1.0,\n\t\t\t\"ValuePosition\": \"top\",\n\t\t\t\"LableAngle\": 0\n\t\t\t};\n\n        var panel = {};\n        var elem = {};\n        var ctrl = {};\n\n        _.defaults(this.panel, panelDefaults);\n\n        this.events.on('render', this.onRender.bind(this));\n        this.events.on('data-received', this.onDataReceived.bind(this));\n        this.events.on('data-error', this.onDataError.bind(this));\n        this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\n\n\t\tthis.className = 'michaeldmoore-multistat-panel-' + this.panel.id;\n\t\t//this.svg = d3.select('.' + this.className).append('svg');\t\n    }\n\n    onDataError(err) {\n        this.seriesList = [];\n\t\tthis.data = [];\n\t\tthis.displayStatusMessage(\"Query failure, Status=\" + err.status + \", \" + err.statusText);\n    }\n\n    onInitEditMode() {\n\t\tthis.metricNames = ['min', 'max', 'avg', 'current', 'total', 'name', 'first', 'delta', 'diff', 'range'];\n\t\tthis.sortDirections = ['none', 'ascending', 'descending'];\n\t\tthis.aggregations = ['all', 'last', 'first', 'mean', 'max', 'min'];\n        this.fontSizes = ['20%', '30%', '50%', '70%', '80%', '100%', '110%', '120%', '150%', '170%', '200%', '250%', '300%', '350%', '400%'];\n\t\tthis.valuePositions = ['bar base', 'bar end', 'top'];\n        this.addEditorTab('Columns', 'public/plugins/michaeldmoore-multistat-panel/columns.html', 2);\n        this.addEditorTab('Layout', 'public/plugins/michaeldmoore-multistat-panel/layout.html', 3);\n        this.addEditorTab('Grouping', 'public/plugins/michaeldmoore-multistat-panel/grouping.html', 4);\n        this.addEditorTab('Options', 'public/plugins/michaeldmoore-multistat-panel/options.html', 5);\n        this.addEditorTab('Lines-and-Limits', 'public/plugins/michaeldmoore-multistat-panel/linesandlimits.html', 6);\n    }\n\n\n    onDataReceived(data) {\n\t\tthis.cols = [];\n\t\tif (data.length == 0){\n\t\t\tconsole.log(\"data\");\n\t\t\tconsole.log(data);\n\t\t\tthis.displayStatusMessage(\"No data to show\");\n\t\t\tthis.data = data;\n\t\t\tthis.rows = null;\n\t\t}\n\t\telse if (data[0].type == \"table\"){\n\t\t\tthis.data = data[0];\n\n\t\t\tfor(let i=0; i < this.data.columns.length; i++)\n\t\t\t\tthis.cols[i] = this.data.columns[i].text;\n\t\t\tthis.cols0 = [''].concat(this.cols);\n\n\t\t\tthis.render();\n\t\t}\n\t\telse {\n\t\t\tappEvents.emit('alert-error', ['Non-Table type data received', 'Multistat does not support Time Series data sets']);\n\t\t}\n    }\n\n\tbuildDateHtml(dateTimeCol){\n\t\tvar $title = this.elem.closest('.panel-container').find('.panel-title');\n\t\tvar $maxDate = $title.find('span.michaeldmoore-multistat-panel-maxDate');\n\n\t\tif($maxDate.length == 0)\n\t\t\t$maxDate = $title.append('<span class=\"michaeldmoore-multistat-panel-maxDate\"/>').children().last();\n\n\t\tif (dateTimeCol != -1 && this.panel.ShowDate) {\n\t\t\tvar maxDate = this.rows[0][dateTimeCol];\n\n\t\t\tfor(let i = 1; i < this.rows.length; i++){\n\t\t\t\tif (maxDate < this.rows[i][dateTimeCol])\n\t\t\t\t\tmaxDate = this.rows[i][dateTimeCol];\n\t\t\t}\n\t\t\t\n\t\t\tvar dd = moment(maxDate).add(this.panel.TZOffsetHours, 'h');\n\t\t\t\n\t\t\tif (this.panel.DateFormat.toUpperCase() == 'ELAPSED')\n\t\t\t\t$maxDate.text(dd.fromNow()).show();\n\t\t\telse\n\t\t\t\t$maxDate.text(dd.format(this.panel.DateFormat)).show();\n\t\t}\n\t\telse\n\t\t\t$maxDate.hide();\t\t\t\n\t}\n\n\tdisplayStatusMessage(msg)\n\t{\n\t\tthis.elem.html(\"<div class='michaeldmoore-multistat-panel-statusmessage'>\" + msg + \"</div>\");\n\t}\n\n    onRender()\n\t{\t\n\t\tif (this.data != null && this.data.rows != null) {\n\t\t\tvar cols = this.cols;\n\t\t\tvar dateTimeCol = -1;\n\t\t\tvar labelCol = -1;\n\t\t\tvar valueCol = 0;\n\t\t\tvar sortCol = 0;\n\t\t\tvar groupCol = -1;\n\t\t\tfor(let i = 0; i < cols.length; i++){\n\t\t\t\tif (cols[i] == this.panel.DateTimeColName)\n\t\t\t\t\tdateTimeCol = i;\n\t\t\t\tif (cols[i] == this.panel.LabelColName)\n\t\t\t\t\tlabelCol = i;\n\t\t\t\tif (cols[i] == this.panel.ValueColName)\n\t\t\t\t\tvalueCol = i;\n\t\t\t\tif (cols[i] == this.panel.SortColName)\n\t\t\t\t\tsortCol = i;\n\t\t\t\tif (cols[i] == this.panel.GroupColName)\n\t\t\t\t\tgroupCol = i;\n\t\t\t}\n\n\t\t\tif (this.panel.LabelNameFilter.length > 0 && labelCol != -1)\n\t\t\t{\n\t\t\t\tvar regex = new RegExp(this.panel.LabelNameFilter, \"\");\n\t\t\t\tthis.matchingRows = [];\n\t\t\t\tfor(let i = 0; i < this.data.rows.length; i++)\n\t\t\t\t{\n\t\t\t\t\tvar dd = this.data.rows[i];\n\t\t\t\t\tvar label = dd[labelCol];\n\t\t\t\t\tif (label.match(regex) != null)\n\t\t\t\t\t\tthis.matchingRows.push(dd);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (this.matchingRows.length == 0)\n\t\t\t\t{\n\t\t\t\t\tthis.displayStatusMessage(\"No data.  Regex filter '\" + this.panel.LabelNameFilter + \"' eliminated all \" + this.data.rows.length + \" rows from current query\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t\tthis.matchingRows = this.data.rows;\n\t\t\t\n\t\t\n\t\t\n\t\t\tif (this.panel.Aggregate != 'all' && labelCol != -1){\n\t\t\t\tvar oo = [];\n\t\t\t\tthis.rows = [];\n\t\t\t\tswitch(this.panel.Aggregate) {\n\t\t\t\t\tcase 'first':\n\t\t\t\t\t\tthis.rows = d3.nest()\n\t\t\t\t\t\t\t.key(function(d){return d[labelCol];})\n\t\t\t\t\t\t\t.rollup(function(d){return d[0];})\n\t\t\t\t\t\t\t.entries(this.matchingRows)\n\t\t\t\t\t\t\t.forEach(function(x){oo.push(x.value); });\n\t\t\t\t\t\tthis.rows = oo;\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'last':\n\t\t\t\t\t\tthis.rows = d3.nest()\n\t\t\t\t\t\t\t.key(function(d){return d[labelCol];})\n\t\t\t\t\t\t\t.rollup(function(d){return d[d.length - 1];})\n\t\t\t\t\t\t\t.entries(this.matchingRows)\n\t\t\t\t\t\t\t.forEach(function(x){oo.push(x.value); });\n\t\t\t\t\t\tthis.rows = oo;\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'mean':\n\t\t\t\t\t\tthis.rows = d3.nest()\n\t\t\t\t\t\t\t.key(function(d){return d[labelCol];})\n\t\t\t\t\t\t\t.rollup(function(d){\n\t\t\t\t\t\t\t\tvar dd = Object.values(Object.assign({}, d[d.length - 1]));\n\t\t\t\t\t\t\t\tdd[valueCol] = d3.mean(d, function(d) { return d[valueCol];});\n\t\t\t\t\t\t\t\treturn dd;\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.entries(this.matchingRows)\n\t\t\t\t\t\t\t.forEach(function(x){oo.push(x.value); });\n\t\t\t\t\t\tthis.rows = Array.from(oo);\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'max':\n\t\t\t\t\t\tthis.rows = d3.nest()\n\t\t\t\t\t\t\t.key(function(d){return d[labelCol];})\n\t\t\t\t\t\t\t.rollup(function(d){\n\t\t\t\t\t\t\t\tvar dd = Object.values(Object.assign({}, d[d.length - 1]));\n\t\t\t\t\t\t\t\tdd[valueCol] = d3.max(d, function(d) { return d[valueCol];});\n\t\t\t\t\t\t\t\treturn dd;\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.entries(this.matchingRows)\n\t\t\t\t\t\t\t.forEach(function(x){oo.push(x.value); });\n\t\t\t\t\t\tthis.rows = Array.from(oo);\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'min':\n\t\t\t\t\t\tthis.rows = d3.nest()\n\t\t\t\t\t\t\t.key(function(d){return d[labelCol];})\n\t\t\t\t\t\t\t.rollup(function(d){\n\t\t\t\t\t\t\t\tvar dd = Object.values(Object.assign({}, d[d.length - 1]));\n\t\t\t\t\t\t\t\tdd[valueCol] = d3.min(d, function(d) { return d[valueCol];});\n\t\t\t\t\t\t\t\treturn dd;\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.entries(this.matchingRows)\n\t\t\t\t\t\t\t.forEach(function(x){oo.push(x.value); });\n\t\t\t\t\t\tthis.rows = Array.from(oo);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.rows = this.matchingRows;\n\t\t\t}\t\t\n\n\t\t\t\n\t\t\tvar groupNameOffset = this.panel.ShowGroupLabels ? Number(this.panel.GroupLabelFontSize.replace('%','')) * 0.15 : 0;\n\t\t\t\n\t\t\tif (groupCol >= 0){\n\t\t\t\tthis.groupedRows = d3.nest()\n\t\t\t\t\t.key(function(d){return d[groupCol];})\n\t\t\t\t\t.entries(this.rows);\n\n\t\t\t\tif (this.panel.GroupNameFilter.length > 0)\n\t\t\t\t{\n\t\t\t\t\tvar regexGroupRows = new RegExp(this.panel.GroupNameFilter, \"\");\n\t\t\t\t\tlet matchingGroups = [];\n\t\t\t\t\tfor(let i = 0; i < this.groupedRows.length; i++)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet groupName = this.groupedRows[i].key;\n\t\t\t\t\t\tif (groupName.match(regexGroupRows) != null)\n\t\t\t\t\t\t\tmatchingGroups.push(this.groupedRows[i]);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (matchingGroups.length > 0)\n\t\t\t\t\t\tthis.groupedRows = matchingGroups;\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.displayStatusMessage(\"No groups.  Group Regex filter '\" + this.panel.GroupNameFilter + \"' eliminated all \" + this.groupedRows.length + \" groups from current query\");\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlet groupSortString = this.panel.GroupSortString;\t\n\t\t\t\t\n\t\t\t\tthis.groupedRows.sort(\n\t\t\t\t\tfunction(a,b){\n\t\t\t\t\t\tvar aPos = groupSortString.search(a.key);\n\t\t\t\t\t\tvar bPos = groupSortString.search(b.key);\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (aPos == bPos)\n\t\t\t\t\t\t\treturn a.key.localeCompare(b.key);\n\t\t\t\t\t\telse if (aPos == -1)\n\t\t\t\t\t\t\treturn 1;\n\t\t\t\t\t\telse if (bPos == -1)\n\t\t\t\t\t\t\treturn -1;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\treturn aPos - bPos;\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.groupedRows = null;\t\n\n\t\t\t\tif (this.panel.SortDirection != \"none\"){\n\t\t\t\t\tvar ascending = this.panel.SortDirection == \"ascending\";\n\t\t\t\t\tthis.rows.sort(function(x, y){\n\t\t\t\t\t\tvar comp = (x[sortCol] == y[sortCol]) ? 0 : ((x[sortCol] > y[sortCol]) ? 1 : -1);\n\t\t\t\t\t\treturn ascending ? comp : -comp;\n\t\t\t\t\t});\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\tthis.elem.html(\"<svg class='\" + this.className + \"'  style='height:100%; width:100%'></svg>\");\n\t\t\t//this.elem.html(\"<svg class='\" + this.className + \"'  style='height:\" + this.ctrl.height + \"px; width:100%'></svg>\");\n\t\t\tvar $container = this.elem.find('.' + this.className);\n\n\t\t\tvar h = $container.height();\n\t\t\tvar w = $container.width() - 15;\n\t\t\tthis.buildDateHtml(dateTimeCol);\n\t\t\t\n\t\t\tvar horizontal = this.panel.Horizontal;\n\t\t\t\n\t\t\tvar labelMargin = ($.isNumeric(this.panel.LabelMargin) && this.panel.LabelMargin >= 0) ? this.panel.LabelMargin : null;\n\t\t\tvar lowSideMargin = this.panel.LowSideMargin >= 0 ? this.panel.LowSideMargin : 0;\n\t\t\tvar highSideMargin = this.panel.HighSideMargin >= 0 ? this.panel.HighSideMargin : 0;\n\n\t\t\tthis.svg = d3.select('.' + this.className).append('svg');\t\n\t\t\tthis.svg.selectAll(\"rect.michaeldmoore-multistat-panel-bar.highflash\").interrupt();\n\t\t\tthis.svg.selectAll(\"rect.michaeldmoore-multistat-panel-bar.lowflash\").interrupt();\n\n\t\t\tvar id = this.panel.id;\n\t\t\tvar barPadding = this.panel.BarPadding;\n\t\t\tvar baseLineValue = this.panel.BaseLineValue;\n\t\t\tvar minLineValue = this.panel.MinLineValue;\n\t\t\tvar maxLineValue = this.panel.MaxLineValue;\n\t\t\tvar highBarColor = this.panel.HighBarColor;\n\t\t\tvar lowBarColor = this.panel.LowBarColor;\n\t\t\tvar highLimitValue = this.panel.HighLimitValue;\n\t\t\tvar HighLimitBarColor = this.panel.HighLimitBarColor;\n\t\t\tvar HighLimitBarFlashColor = this.panel.HighLimitBarFlashColor;\n\t\t\tvar HighLimitBarFlashTimeout = this.panel.HighLimitBarFlashTimeout;\n\t\t\tvar recolorHighLimitBar = this.panel.RecolorHighLimitBar;\n\t\t\tvar lowLimitValue = this.panel.LowLimitValue;\n\t\t\tvar LowLimitBarColor = this.panel.LowLimitBarColor;\n\t\t\tvar LowLimitBarFlashColor = this.panel.LowLimitBarFlashColor;\n\t\t\tvar LowLimitBarFlashTimeout = this.panel.LowLimitBarFlashTimeout;\n\t\t\tvar recolorLowLimitBar = this.panel.RecolorLowLimitBar;\n\t\t\tvar flashHighLimitBar = this.panel.FlashHighLimitBar;\n\t\t\tvar flashLowLimitBar = this.panel.FlashLowLimitBar;\n\t\t\tvar showTooltips = this.panel.ShowTooltips;\n\t\t\tvar DateTimeColName = this.panel.DateTimeColName;\n\t\t\tvar DateFormat = this.panel.DateFormat;\n\t\t\tvar TooltipDateFormat = this.panel.TooltipDateFormat;\n\t\t\tvar ValueColName = this.panel.ValueColName;\n\t\t\tvar ValueDecimals = this.panel.ValueDecimals;\n\t\t\tvar OddRowColor = this.panel.OddRowColor;\n\t\t\tvar EvenRowColor = this.panel.EvenRowColor;\n\t\t\tvar TZOffsetHours = this.panel.TZOffsetHours;\n\t\t\tvar GroupCols = this.panel.GroupCols;\n\t\t\tvar GroupGap = this.panel.GroupGap;\n\t\t\tvar ScaleFactor = Number(this.panel.ScaleFactor);\n\t\t\tvar LabelColor = this.panel.LabelColor;\n\t\t\tvar ValuePosition = this.panel.ValuePosition;\n\t\t\t\n\t\t\tvar minValue = d3.min(this.rows, function(d) { return Number(d[valueCol]) * ScaleFactor; });\n\t\t\tif ($.isNumeric(minLineValue) == false)\n\t\t\t\tminLineValue = minValue;\n\t\t\t\n\t\t\tvar maxValue = d3.max(this.rows, function(d) { return Number(d[valueCol]) * ScaleFactor; });\n\t\t\tif ($.isNumeric(maxLineValue) == false)\n\t\t\t\tmaxLineValue = maxValue;\t\t\t\t\n\t\t\t\n\t\t\tif ($.isNumeric(baseLineValue) == false)\n\t\t\t\tbaseLineValue = 0;\n\t\t\t\n\t\t\tif (minLineValue > baseLineValue)\n\t\t\t\tminLineValue = baseLineValue;\n\t\t\t\n\t\t\tif ($.isNumeric(lowLimitValue) && minLineValue > lowLimitValue)\n\t\t\t\tminLineValue = lowLimitValue;\n\t\t\t\n\t\t\tif (maxLineValue < baseLineValue)\n\t\t\t\tmaxLineValue = baseLineValue;\n\t\t\t\n\t\t\tif ($.isNumeric(highLimitValue) && maxLineValue < highLimitValue)\n\t\t\t\tmaxLineValue = highLimitValue;\n\n\t\t\td3.select(\"body\").append(\"div\")\n\t\t\t\t.attr(\"class\", \"michaeldmoore-multistat-panel-tooltip michaeldmoore-multistat-panel-tooltip-\" + id)\n\t\t\t\t.style(\"opacity\", 0);\n\t\t\t\n\t\t\tvar tooltipShow = function(d, c, id){\n\t\t\t\tvar tooltipDiv = d3.select(\".michaeldmoore-multistat-panel-tooltip-\" + id);\n\t\t\t\ttooltipDiv.transition()\n\t\t\t\t.duration(200)\n\t\t\t\t.style(\"opacity\", 0.9);\n\t\t\t\tvar html = \"<table>\";\n\t\t\t\tfor (var i = 0; i < d.length; i++){\n\t\t\t\t\tvar cc = c[i];\n\t\t\t\t\tvar dd = d[i];\n\t\t\t\t\t\n\t\t\t\t\tif (cc == DateTimeColName)\n\t\t\t\t\t\tdd = moment(dd).add(TZOffsetHours, 'h').format(TooltipDateFormat);\n\t\t\t\t\telse if (cc == ValueColName && $.isNumeric(dd))\n\t\t\t\t\t\tdd = Number(dd).toFixed(ValueDecimals);\n\t\t\t\t\t\n\t\t\t\t\thtml += \"<tr><td>\" + cc + \"</td><td>\" + dd + \"</td></tr>\";\n\t\t\t\t}\n\t\t\t\thtml += \"</table>\";\n\t\t\t\ttooltipDiv.html(html)\n\t\t\t\t.style(\"left\", d3.event.pageX + \"px\")\n\t\t\t\t.style(\"top\", (d3.event.pageY - 28) + \"px\");\n\t\t\t};\n\n\t\t\tvar tooltipHide = function(id) {\n\t\t\t\tvar tooltipDiv = d3.selectAll(\".michaeldmoore-multistat-panel-tooltip-\" + id);\n\t\t\t\ttooltipDiv.transition()\t\t\n\t\t\t\t.duration(500)\t\t\n\t\t\t\t.style(\"opacity\", 0);\t\n\t\t\t};\n\t\t\t\n\t\t\tvar scaleAndClipValue = function(d) {\n\t\t\t\tvar val = d * ScaleFactor;\n\t\t\t\tif (val > maxLineValue)\n\t\t\t\t\tval = maxLineValue;\n\t\t\t\tif (val < minLineValue)\n\t\t\t\t\tval = minLineValue;\n\t\t\t\t\n\t\t\t\treturn val;\n\t\t\t};\n\n\t\t\tif(horizontal) {\n\t\t\t\tvar plotGroupHorizontal = function(panel, svg, data, numRows, groupName, groupNameOffset, left, w, hh, dh) {\n\n\t\t\t\t\t// draw border rectangle\n\t\t\t\t\t/*svg.append(\"rect\")\n\t\t\t\t\t\t.attr(\"width\", w)\n\t\t\t\t\t\t.attr(\"height\", dh)\n\t\t\t\t\t\t.attr(\"x\", left)\n\t\t\t\t\t\t.attr(\"y\", hh)\n\t\t\t\t\t\t.attr(\"stroke\", \"yellow\");*/\n\n\t\t\t\t\tif (panel.SortDirection != \"none\"){\n\t\t\t\t\t\tvar ascending = panel.SortDirection == \"ascending\";\n\t\t\t\t\t\tdata.sort(function(x, y){\n\t\t\t\t\t\t\tvar comp = (x[sortCol] == y[sortCol]) ? 0 : ((x[sortCol] > y[sortCol]) ? 1 : -1);\n\t\t\t\t\t\t\treturn ascending ? comp : -comp;\n\t\t\t\t\t\t});\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// Add Above-High Side Group Names\n\t\t\t\t\tif(groupName != '' && panel.ShowGroupLabels) {\n\t\t\t\t\t\tsvg\n\t\t\t\t\t\t\t.append(\"text\")\n\t\t\t\t\t\t\t.text(groupName)\n\t\t\t\t\t\t\t.attr(\"x\", left + (labelMargin + w)/2)\n\t\t\t\t\t\t\t.attr(\"y\", hh + groupNameOffset/2)\n\t\t\t\t\t\t\t.attr(\"font-family\", \"sans-serif\")\n\t\t\t\t\t\t\t.attr(\"font-size\", panel.GroupLabelFontSize)\n\t\t\t\t\t\t\t.attr(\"fill\", panel.GroupLabelColor)\n\t\t\t\t\t\t\t.attr(\"background\", \"blue\")\n\t\t\t\t\t\t\t.attr(\"text-anchor\", \"middle\")\n\t\t\t\t\t\t\t.attr(\"dominant-baseline\", \"central\");\n\t\t\t\t\t}\n\n\t\t\t\t\thh += groupNameOffset;\n\t\t\t\t\tdh -= groupNameOffset;\n\n\t\t\t\t\t// draw border rectangle\n\t\t\t\t\t/*svg.append(\"rect\")\n\t\t\t\t\t\t.attr(\"width\", w)\n\t\t\t\t\t\t.attr(\"height\", dh)\n\t\t\t\t\t\t.attr(\"x\", left)\n\t\t\t\t\t\t.attr(\"y\", hh)\n\t\t\t\t\t\t.attr(\"stroke\", \"#ffffff\");*/\n\t\t\t\t\t\t\n\t\t\t\t\tvar labels = data.map(function(d){ return d[labelCol]; });\n\t\t\t\t\twhile (labels.length < numRows)\n\t\t\t\t\t\tlabels = labels.concat('_' + Math.random().toString(36).substr(2, 9));\n\t\t\t\t\t\n\t\t\t\t\tvar labelScale = d3.scaleBand()\n\t\t\t\t\t\t\t\t.domain(labels)\n\t\t\t\t\t\t\t\t.rangeRound([hh + highSideMargin, hh + dh - lowSideMargin])\n\t\t\t\t\t\t\t\t.paddingInner(barPadding / 100)\n\t\t\t\t\t\t\t\t.paddingOuter(barPadding / 200);\n\t\t\t\t\n\t\t\t\t\tvar stripedata = data.concat(d3.range(data.length, numRows));\n\t\t\t\t\t\n\t\t\t\t\tvar stripeScale = d3.scaleBand()\n\t\t\t\t\t\t\t\t.domain(stripedata)\n\t\t\t\t\t\t\t\t.rangeRound([hh + highSideMargin, hh + dh - lowSideMargin]);\n\t\t\t\t\n\t\t\t\t\t// Draw background of alternating stripes \n\t\t\t\t\tvar oddeven = false;\n\t\t\t\t\tsvg.append(\"g\")\n\t\t\t\t\t\t.selectAll(\"rect\")\n\t\t\t\t\t\t.data(stripedata)\n\t\t\t\t\t\t.enter()\n\t\t\t\t\t\t.append(\"rect\")\n\t\t\t\t\t\t.attr(\"class\", \"michaeldmoore-multistat-panel-row\")\n\t\t\t\t\t\t.attr(\"width\", w)\n\t\t\t\t\t\t.attr(\"height\", stripeScale.step())\n\t\t\t\t\t\t.attr(\"x\", left)\n\t\t\t\t\t\t.attr(\"y\", function(d){return stripeScale(d);})\n\t\t\t\t\t\t.attr(\"fill\", function(d) { \n\t\t\t\t\t\t\t\toddeven = !oddeven;\n\t\t\t\t\t\t\t\treturn oddeven ? OddRowColor : EvenRowColor;\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t.on(\"mouseover\", function(d, i) {\n\t\t\t\t\t\t\tif (showTooltips && i < data.length)\n\t\t\t\t\t\t\t\ttooltipShow(d, cols, id);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t.on(\"mouseout\", function() { \n\t\t\t\t\t\t\ttooltipHide(id);\n\t\t\t\t\t\t\t});\n\n\n\t\t\t\t\tvar gg = svg\n\t\t\t\t\t\t.append(\"g\")\n\t\t\t\t\t\t.selectAll(\"text\")\n\t\t\t\t\t\t.data(data)\n\t\t\t\t\t\t.enter()\n\t\t\t\t\t\t.append(\"g\");\n\t\t\t\t\t\n\t\t\t\t\tif (panel.ShowValues && panel.ValuePosition == \"top\") {\n\t\t\t\t\t\tvar maxValueWidth = 0;\n\t\t\t\t\t\tgg.append(\"text\")\n\t\t\t\t\t\t.text(function(d) {return (Number(d[valueCol]) * ScaleFactor).toFixed(ValueDecimals);})\n\t\t\t\t\t\t.attr(\"x\", left + w)\n\t\t\t\t\t\t.attr(\"y\", function(d,i){return labelScale(d[labelCol]) + (labelScale.bandwidth() / 2);})\n\t\t\t\t\t\t.attr(\"font-family\", \"sans-serif\")\n\t\t\t\t\t\t.attr(\"font-size\", panel.ValueFontSize)\n\t\t\t\t\t\t.attr(\"fill\", panel.ValueColor)\n\t\t\t\t\t\t.attr(\"text-anchor\", \"end\")\n\t\t\t\t\t\t.attr(\"dominant-baseline\", \"central\")\n\t\t\t\t\t\t.each(function(d,i) {\n\t\t\t\t\t\t\tvar thisWidth = this.getComputedTextLength();\n\t\t\t\t\t\t\tmaxValueWidth = d3.max([maxValueWidth, thisWidth]);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tw -= maxValueWidth;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\tif (panel.ShowLabels) {\n\t\t\t\t\t\tvar maxLabelWidth = 0;\n\t\t\t\t\t\tvar labelAngle = Number(panel.LableAngle); \n\t\t\t\t\t\tgg.append(\"text\")\n\t\t\t\t\t\t.text(function(d) { return d[labelCol]; })\n\t\t\t\t\t\t.attr(\"font-family\", \"sans-serif\")\n\t\t\t\t\t\t.attr(\"font-size\", panel.LabelFontSize)\n\t\t\t\t\t\t.attr(\"fill\", function(d,i){return d[valueCol] * ScaleFactor > maxLineValue || d[valueCol] * ScaleFactor < minLineValue ? panel.OutOfRangeLabelColor : panel.LabelColor; })\n\t\t\t\t\t\t.attr(\"text-anchor\", \"middle\")\n\t\t\t\t\t\t.attr(\"dominant-baseline\", \"central\")\n\t\t\t\t\t\t.attr(\"transform\", function(d, i) { \n\t\t\t\t\t\t\tvar bbox = this.getBBox();\n\t\t\t\t\t\t\tvar s = Math.sin(labelAngle * Math.PI / 180);\n\t\t\t\t\t\t\tvar c = Math.cos(labelAngle * Math.PI / 180);\n\t\t\t\t\t\t\tvar b = Math.abs(bbox.width * s) + Math.abs(bbox.height * c);\n\t\t\t\t\t\t\tvar a = Math.abs(bbox.width * c) + Math.abs(bbox.height * s);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tvar y =  labelScale(d[labelCol]) + (labelScale.bandwidth() / 2);\n\t\t\t\t\t\t\tvar x = left + a/2;\n\t\t\t\t\t\t\treturn \"translate(\"+x+\",\"+y+\") rotate(\"+labelAngle+\")\";\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.on(\"mouseover\", function(d) {\n\t\t\t\t\t\t\tif (showTooltips)\n\t\t\t\t\t\t\t\ttooltipShow(d, cols, id);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t.on(\"mouseout\", function() { \n\t\t\t\t\t\t\ttooltipHide(id);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t.each(function(d,i) {\n\t\t\t\t\t\t\tvar bbox = this.getBBox();\n\t\t\t\t\t\t\tvar s = Math.sin(labelAngle * Math.PI / 180);\n\t\t\t\t\t\t\tvar c = Math.cos(labelAngle * Math.PI / 180);\n\t\t\t\t\t\t\tvar b = Math.abs(bbox.width * s) + Math.abs(bbox.height * c);\n\t\t\t\t\t\t\tvar a = Math.abs(bbox.width * c) + Math.abs(bbox.height * s);\n\n\t\t\t\t\t\t\tvar thisWidth = a;\n\t\t\t\t\t\t\tmaxLabelWidth = d3.max([maxLabelWidth, thisWidth]);\n\t\t\t\t\t\t});\n\t\t\t\t\t\t\n\t\t\t\t\t\tif ($.isNumeric(labelMargin)){\n\t\t\t\t\t\t\tleft += labelMargin;\n\t\t\t\t\t\t\tw -= labelMargin;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tleft += maxLabelWidth;\n\t\t\t\t\t\t\tw -= maxLabelWidth;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\tvar valueScale = d3.scaleLinear()\n\t\t\t\t\t\t.domain([minLineValue, maxLineValue])\n\t\t\t\t\t\t.range([left + labelMargin, left + w])\n\t\t\t\t\t\t.nice();\n\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\tfunction vLine(svg, value, color) {\t\n\t\t\t\t\t\tsvg.append(\"line\")\n\t\t\t\t\t\t\t.style(\"stroke\", color)\n\t\t\t\t\t\t\t.attr(\"y1\", hh + highSideMargin)\n\t\t\t\t\t\t\t.attr(\"x1\", valueScale(value))\n\t\t\t\t\t\t\t.attr(\"y2\", hh + dh - lowSideMargin)\n\t\t\t\t\t\t\t.attr(\"x2\", valueScale(value));\n\t\t\t\t\t}\t\t\t\n\n\t\t\t\t\tif(panel.ShowBaseLine)\n\t\t\t\t\t\tvLine(svg, baseLineValue, panel.BaseLineColor);\n\n\t\t\t\t\tif(panel.ShowMaxLine)\n\t\t\t\t\t\tvLine(svg, maxLineValue, panel.MaxLineColor);\n\n\t\t\t\t\tif(panel.ShowMinLine)\n\t\t\t\t\t\tvLine(svg, minLineValue, panel.MinLineColor);\n\n\t\t\t\t\tif(panel.ShowHighLimitLine)\n\t\t\t\t\t\tvLine(svg, highLimitValue, panel.HighLimitLineColor);\n\n\t\t\t\t\tif(panel.ShowLowLimitLine)\n\t\t\t\t\t\tvLine(svg, lowLimitValue, panel.LowLimitLineColor);\n\n\t\t\t\t\tsvg\n\t\t\t\t\t\t.append(\"g\")\n\t\t\t\t\t\t.selectAll(\"rect\")\n\t\t\t\t\t\t.data(data)\n\t\t\t\t\t\t.enter()\n\t\t\t\t\t\t.append(\"rect\")\n\t\t\t\t\t\t.attr(\"class\", \"michaeldmoore-multistat-panel-bar\")\n\t\t\t\t\t\t.attr(\"width\", function(d) {\n\t\t\t\t\t\t\tvar val = scaleAndClipValue(d[valueCol]);\n\t\t\t\t\t\t\treturn Math.abs(valueScale(val) - valueScale(baseLineValue));\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t.attr(\"height\", labelScale.bandwidth())\n\t\t\t\t\t\t.attr(\"x\", function(d) { \n\t\t\t\t\t\t\tvar val = scaleAndClipValue(d[valueCol]);\n\t\t\t\t\t\t\treturn d3.min([valueScale(val), valueScale(baseLineValue)]); \n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t.attr(\"y\", function(d,i){return labelScale(d[labelCol]);})\n\t\t\t\t\t\t.attr(\"fill\", function(d) { \n\t\t\t\t\t\t\tif (recolorHighLimitBar && (d[valueCol] * ScaleFactor > highLimitValue))\n\t\t\t\t\t\t\t\treturn HighLimitBarColor;\n\t\t\t\t\t\t\tif (recolorLowLimitBar && (d[valueCol] * ScaleFactor < lowLimitValue))\n\t\t\t\t\t\t\t\treturn LowLimitBarColor;\n\t\t\t\t\t\t\treturn (d[valueCol] * ScaleFactor > baseLineValue) ? highBarColor : lowBarColor;\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t.classed(\"highflash\", function(d) { \n\t\t\t\t\t\t\treturn recolorHighLimitBar && flashHighLimitBar && (d[valueCol] * ScaleFactor > highLimitValue);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t.classed(\"lowflash\", function(d) { \n\t\t\t\t\t\t\treturn recolorLowLimitBar && flashLowLimitBar && (d[valueCol] * ScaleFactor < lowLimitValue);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t.on(\"mouseover\", function(d) {\n\t\t\t\t\t\t\tif (showTooltips)\n\t\t\t\t\t\t\t\ttooltipShow(d, cols, id);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t.on(\"mouseout\", function() { \n\t\t\t\t\t\t\ttooltipHide(id);\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\tvar g = svg\n\t\t\t\t\t\t\t.append(\"g\")\n\t\t\t\t\t\t\t.selectAll(\"text\")\n\t\t\t\t\t\t\t.data(data)\n\t\t\t\t\t\t\t.enter()\n\t\t\t\t\t\t\t.append(\"g\");\n\t\t\t\t\t\n\t\t\t\t\tif (panel.ShowValues && panel.ValuePosition != \"top\") {\n\t\t\t\t\t\tg.append(\"text\")\n\t\t\t\t\t\t.text(function(d) {return (Number(d[valueCol]) * ScaleFactor).toFixed(ValueDecimals);})\n\t\t\t\t\t\t.attr(\"x\", function(d){\n\t\t\t\t\t\t\tif (panel.ValuePosition == \"bar base\")\n\t\t\t\t\t\t\t\treturn valueScale(baseLineValue);// + 5;\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tvar val = scaleAndClipValue(d[valueCol]);\n\t\t\t\t\t\t\t\treturn valueScale(val) + ((val > baseLineValue)); // ? - 5 : + 5)\n\t\t\t\t\t\t\t}})\n\t\t\t\t\t\t.attr(\"y\", function(d,i){return labelScale(d[labelCol]) + (labelScale.bandwidth() / 2);})\n\t\t\t\t\t\t.attr(\"font-family\", \"sans-serif\")\n\t\t\t\t\t\t.attr(\"font-size\", panel.ValueFontSize)\n\t\t\t\t\t\t.attr(\"fill\", panel.ValueColor)\n\t\t\t\t\t\t.attr(\"text-anchor\", function(d){\n\t\t\t\t\t\t\tif (panel.ValuePosition == \"bar base\")\n\t\t\t\t\t\t\t\treturn (d[valueCol] * ScaleFactor > baseLineValue) ? \"start\" : \"end\";\n\t\t\t\t\t\t\t\t//return \"start\";\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\treturn (d[valueCol] * ScaleFactor > baseLineValue) ? \"end\" : \"start\";\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t.attr(\"dominant-baseline\", \"central\");\n\t\t\t\t\t}\n\n\t\t\t\t\t//Add High Side Value Axis (X)\n\t\t\t\t\tif (highSideMargin > 0) {\n\t\t\t\t\t\tvar ggHighSide = svg\n\t\t\t\t\t\t\t\t.append(\"g\")\n\t\t\t\t\t\t\t\t.attr(\"transform\", 'translate(1,' + (hh + highSideMargin) + ')')\n\t\t\t\t\t\t\t\t.attr(\"class\", \"michaeldmoore-multistat-panel-valueaxis\")\n\t\t\t\t\t\t\t\t.call(d3.axisTop(valueScale));\n\t\t\t\t\t\tggHighSide.selectAll('.tick text').attr('fill', panel.HighAxisColor);\n\t\t\t\t\t\tggHighSide.selectAll('.tick line').attr('stroke', panel.HighAxisColor);\n\t\t\t\t\t\tggHighSide.selectAll('path.domain').attr('stroke', panel.HighAxisColor);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t//Add Low Side Value Axis (X)\n\t\t\t\t\tif (lowSideMargin > 0) {\t\n\t\t\t\t\t\tvar ggLowSide = svg\n\t\t\t\t\t\t\t\t.append(\"g\")\n\t\t\t\t\t\t\t\t.attr(\"transform\", 'translate(0,' + (hh + dh - lowSideMargin) + ')')\n\t\t\t\t\t\t\t\t.attr(\"class\", \"michaeldmoore-multistat-panel-valueaxis\")\n\t\t\t\t\t\t\t\t.call(d3.axisBottom(valueScale));\n\t\t\t\t\t\tggLowSide.selectAll('.tick text').attr('fill', panel.LowAxisColor);\n\t\t\t\t\t\tggLowSide.selectAll('.tick line').attr('stroke', panel.LowAxisColor);\n\t\t\t\t\t\tggLowSide.selectAll('path.domain').attr('stroke', panel.LowAxisColor);\n\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t};\n\n\t\t\t\tif (this.groupedRows != null){\n\t\t\t\t\tvar gcols = (GroupCols <= 0 || GroupCols > this.groupedRows.length) ? this.groupedRows.length : GroupCols;\n\t\t\t\t\tvar dw = ((w + GroupGap) / gcols);\n\n\t\t\t\t\t// figure out the max data points in each row of groups...\n\t\t\t\t\tvar pointsPerRow = [];\n\t\t\t\t\tfor(let i = 0; i < this.groupedRows.length/gcols; i++)\n\t\t\t\t\t\tpointsPerRow.push(0);\n\t\t\t\t\tfor(let i = 0; i < this.groupedRows.length; i++)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet rr = Math.floor(i / gcols);\n\t\t\t\t\t\tlet u = this.groupedRows[i].values.length;\n\t\t\t\t\t\tif (pointsPerRow[rr] < u)\n\t\t\t\t\t\t\tpointsPerRow[rr] = u;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar totalPoints = 0;\n\t\t\t\t\tfor(let i = 0; i < pointsPerRow.length; i++)\n\t\t\t\t\t\ttotalPoints += pointsPerRow[i];\n\t\t\t\t\t\n\t\t\t\t\tvar rowOverheadHeight = groupNameOffset + this.panel.LowSideMargin + this.panel.HighSideMargin;\n\t\t\t\t\tvar rowHeight = (h - (pointsPerRow.length * rowOverheadHeight)) / totalPoints;\t\t\t\t\t\n\n\t\t\t\t\tvar numRows = Math.ceil(this.groupedRows.length / gcols);\n\t\t\t\t\tvar hh = 0;\n\t\t\t\t\tfor (var rr = 0; rr < numRows; rr++)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar nn = pointsPerRow[rr];\n\t\t\t\t\t\tvar dh = rowOverheadHeight + (nn * rowHeight);\n\t\t\t\t\t\thh += dh;\n\t\t\t\t\t\tfor (var cc = 0; cc < gcols; cc++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar ii = cc + (rr * gcols);\n\t\t\t\t\t\t\tif (ii < this.groupedRows.length)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tplotGroupHorizontal(this.panel, this.svg, this.groupedRows[ii].values, nn, this.groupedRows[ii].key, groupNameOffset, \n\t\t\t\t\t\t\t\t\tcc * dw, dw - GroupGap, hh - dh, dh);\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tplotGroupHorizontal(this.panel, this.svg, this.rows, this.rows.length, '', 0, 0, w, 0, h);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar plotGroupVertical = function(panel, svg, data, numRows, groupName, groupNameOffset, left, w, hh, dh) \n\t\t\t\t{\n\t\t\t\t\t// draw border rectangle\n\t\t\t\t\t/*svg.append(\"rect\")\n\t\t\t\t\t\t.attr(\"width\", w)\n\t\t\t\t\t\t.attr(\"height\", dh)\n\t\t\t\t\t\t.attr(\"x\", left)\n\t\t\t\t\t\t.attr(\"y\", hh)\n\t\t\t\t\t\t.attr(\"stroke\", \"yellow\");*/\n\n\t\t\t\t\tif (panel.SortDirection != \"none\"){\n\t\t\t\t\t\tvar ascending = panel.SortDirection == \"ascending\";\n\t\t\t\t\t\tdata.sort(function(x, y){\n\t\t\t\t\t\t\tvar comp = (x[sortCol] == y[sortCol]) ? 0 : ((x[sortCol] > y[sortCol]) ? 1 : -1);\n\t\t\t\t\t\t\treturn ascending ? comp : -comp;\n\t\t\t\t\t\t});\t\t\t\t\n\t\t\t\t\t}\n\n\t\t\t\t\t// Add Above-High Side Group Names\n\t\t\t\t\tif(groupName != '' && panel.ShowGroupLabels) {\n\t\t\t\t\t\tsvg\n\t\t\t\t\t\t\t.append(\"text\")\n\t\t\t\t\t\t\t.text(groupName)\n\t\t\t\t\t\t\t.attr(\"x\", left + (labelMargin + w)/2)\n\t\t\t\t\t\t\t.attr(\"y\", hh + groupNameOffset/2)\n\t\t\t\t\t\t\t.attr(\"font-family\", \"sans-serif\")\n\t\t\t\t\t\t\t.attr(\"font-size\", panel.GroupLabelFontSize)\n\t\t\t\t\t\t\t.attr(\"fill\", panel.GroupLabelColor)\n\t\t\t\t\t\t\t.attr(\"background\", \"blue\")\n\t\t\t\t\t\t\t.attr(\"text-anchor\", \"middle\")\n\t\t\t\t\t\t\t.attr(\"dominant-baseline\", \"central\");\n\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\thh += groupNameOffset;\n\t\t\t\t\tdh -= groupNameOffset;\n\n\t\t\t\t\t// draw border rectangle\n\t\t\t\t\t/*svg.append(\"rect\")\n\t\t\t\t\t\t.attr(\"width\", w)\n\t\t\t\t\t\t.attr(\"height\", dh)\n\t\t\t\t\t\t.attr(\"x\", left)\n\t\t\t\t\t\t.attr(\"y\", hh)\n\t\t\t\t\t\t.attr(\"stroke\", \"#ffffff\");*/\n\n\n\t\t\t\t\tvar labels = data.map(function(d){ return d[labelCol]; });\n\t\t\t\t\twhile (labels.length < numRows)\n\t\t\t\t\t\tlabels = labels.concat('_' + Math.random().toString(36).substr(2, 9));\n\t\t\t\t\t\n\n\t\t\t\t\tvar labelScale = d3.scaleBand()\n\t\t\t\t\t\t\t\t.domain(labels)\n\t\t\t\t\t\t\t\t.range([left + lowSideMargin, left + w - highSideMargin])\n\t\t\t\t\t\t\t\t.paddingInner(barPadding / 100)\n\t\t\t\t\t\t\t\t.paddingOuter(barPadding / 200);\n\n\t\t\t\t\t\t\t\t\n\t\t\t\t\tvar stripedata = data.concat(d3.range(data.length, numRows));\n\t\t\t\t\t\n\t\t\t\t\tvar stripeScale = d3.scaleBand()\n\t\t\t\t\t\t\t\t.domain(stripedata)\n\t\t\t\t\t\t\t\t.range([left + lowSideMargin, left + w - highSideMargin]);\n\t\t\t\t\t\t\n\t\t\t\t\t// Draw background of alternating stripes \n\t\t\t\t\tvar oddeven = false;\n\t\t\t\t\tsvg.append(\"g\")\n\t\t\t\t\t\t.selectAll(\"rect\")\n\t\t\t\t\t\t.data(stripedata)\n\t\t\t\t\t\t.enter()\n\t\t\t\t\t\t.append(\"rect\")\n\t\t\t\t\t\t.attr(\"class\", \"michaeldmoore-multistat-panel-row\")\n\t\t\t\t\t\t.attr(\"width\", stripeScale.step())\n\t\t\t\t\t\t.attr(\"height\", dh)\n\t\t\t\t\t\t.attr(\"x\", function(d,i){return stripeScale(d);})\n\t\t\t\t\t\t.attr(\"y\", hh)\n\t\t\t\t\t\t.attr(\"fill\", function(d) { \n\t\t\t\t\t\t\t\toddeven = !oddeven;\n\t\t\t\t\t\t\t\treturn oddeven ? OddRowColor : EvenRowColor;\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t.on(\"mouseover\", function(d, i) {\n\t\t\t\t\t\t\tif (showTooltips && i < data.length)\n\t\t\t\t\t\t\t\ttooltipShow(d, cols, id);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t.on(\"mouseout\", function() { \n\t\t\t\t\t\t\ttooltipHide(id);\n\t\t\t\t\t\t\t});\n\n\n\n\t\t\t\tvar gg = svg\n\t\t\t\t\t.append(\"g\")\n\t\t\t\t\t.selectAll(\"text\")\n\t\t\t\t\t.data(data)\n\t\t\t\t\t.enter()\n\t\t\t\t\t.append(\"g\");\n\t\t\t\t\t\n\t\t\t\tif (panel.ShowValues && panel.ValuePosition == \"top\") {\n\t\t\t\t\tvar maxValueHeight = 0;\n\t\t\t\t\tgg.append(\"text\")\n\t\t\t\t\t.text(function(d) {return (Number(d[valueCol]) * ScaleFactor).toFixed(ValueDecimals);})\n\t\t\t\t\t.attr(\"x\", function(d, i) { return labelScale(d[labelCol]) + (labelScale.bandwidth() / 2); })\n\t\t\t\t\t.attr(\"y\", hh)\n\t\t\t\t\t.attr(\"font-family\", \"sans-serif\")\n\t\t\t\t\t.attr(\"font-size\", panel.ValueFontSize)\n\t\t\t\t\t.attr(\"fill\", panel.ValueColor)\n\t\t\t\t\t.attr(\"text-anchor\", \"middle\")\n\t\t\t\t\t.attr(\"dominant-baseline\", \"text-before-edge\")\n\t\t\t\t\t.each(function(d,i) {\n\t\t\t\t\t\tvar thisHeight = this.getBBox().height;\n\t\t\t\t\t\tmaxValueHeight = d3.max([maxValueHeight, thisHeight]);\n\t\t\t\t\t});\n\t\t\t\t\thh += maxValueHeight;\n\t\t\t\t\tdh -= maxValueHeight;\n\t\t\t\t}\n\n\t\t\t\tif (panel.ShowLabels) {\n\t\t\t\t\tvar maxLabelHeight = 0;\n\t\t\t\t\tvar labelAngle = Number(panel.LableAngle); \n\t\t\t\t\tgg.append(\"text\")\n\t\t\t\t\t.text(function(d) { return d[labelCol]; })\n\t\t\t\t\t.attr(\"font-family\", \"sans-serif\")\n\t\t\t\t\t.attr(\"font-size\", panel.LabelFontSize)\n\t\t\t\t\t.attr(\"fill\", function(d,i){return d[valueCol] * ScaleFactor > maxLineValue || d[valueCol] * ScaleFactor < minLineValue ? panel.OutOfRangeLabelColor : LabelColor; })\n\t\t\t\t\t.attr(\"text-anchor\", \"middle\")\n\t\t\t\t\t.attr(\"dominant-baseline\", \"central\")\n\t\t\t\t\t.attr(\"transform\", function(d, i) { \n\t\t\t\t\t\tvar bbox = this.getBBox();\n\t\t\t\t\t\tvar s = Math.sin(labelAngle * Math.PI / 180);\n\t\t\t\t\t\tvar c = Math.cos(labelAngle * Math.PI / 180);\n\t\t\t\t\t\tvar b = Math.abs(bbox.width * s) + Math.abs(bbox.height * c);\n\t\t\t\t\t\tvar a = Math.abs(bbox.width * c) + Math.abs(bbox.height * s);\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar x =  labelScale(d[labelCol]) + (labelScale.bandwidth() / 2);\n\t\t\t\t\t\tvar y = hh + dh - b/2;\n\t\t\t\t\t\treturn \"translate(\"+x+\",\"+y+\") rotate(\"+labelAngle+\")\";\n\t\t\t\t\t})\t\t\t\t\t\n\t\t\t\t\t.on(\"mouseover\", function(d) {\n\t\t\t\t\t\tif (showTooltips)\n\t\t\t\t\t\t\ttooltipShow(d, cols, id);\n\t\t\t\t\t\t})\n\t\t\t\t\t.on(\"mouseout\", function() { \n\t\t\t\t\t\ttooltipHide(id);\n\t\t\t\t\t\t})\n\t\t\t\t\t.each(function(d,i) {\n\t\t\t\t\t\tvar bbox = this.getBBox();\n\t\t\t\t\t\tvar s = Math.sin(labelAngle * Math.PI / 180);\n\t\t\t\t\t\tvar c = Math.cos(labelAngle * Math.PI / 180);\n\t\t\t\t\t\tvar b = Math.abs(bbox.width * s) + Math.abs(bbox.height * c);\n\t\t\t\t\t\tvar a = Math.abs(bbox.width * c) + Math.abs(bbox.height * s);\n\n\t\t\t\t\t\tvar thisHeight = b;\n\t\t\t\t\t\tmaxLabelHeight = d3.max([maxLabelHeight, thisHeight]);\n\t\t\t\t\t});\n\t\t\t\t\tif ($.isNumeric(labelMargin)){\n\t\t\t\t\t\tdh -= labelMargin;\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tdh -= maxLabelHeight;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar valueScale = d3.scaleLinear()\n\t\t\t\t\t.domain([maxLineValue, minLineValue])\n\t\t\t\t\t.range([hh, hh + dh])\n\t\t\t\t\t.nice();\n\t\t\t\t\n\t\t\t\tfunction hLine(svg, value, color) {\t\n\t\t\t\t\tsvg.append(\"line\")\n\t\t\t\t\t\t.style(\"stroke\", color)\n\t\t\t\t\t\t.attr(\"x1\", left + lowSideMargin)\n\t\t\t\t\t\t.attr(\"y1\", valueScale(value))\n\t\t\t\t\t\t.attr(\"x2\", left + w - highSideMargin)\n\t\t\t\t\t\t.attr(\"y2\", valueScale(value));\n\t\t\t\t}\t\t\t\n\n\t\t\t\t\n\t\t\t\tif(panel.ShowBaseLine)\n\t\t\t\t\thLine(svg, baseLineValue, panel.BaseLineColor);\n\n\t\t\t\tif(panel.ShowMaxLine)\n\t\t\t\t\thLine(svg, maxLineValue, panel.MaxLineColor);\n\n\t\t\t\tif(panel.ShowMinLine)\n\t\t\t\t\thLine(svg, minLineValue, panel.MinLineColor);\n\n\t\t\t\tif(panel.ShowHighLimitLine)\n\t\t\t\t\thLine(svg, highLimitValue, panel.HighLimitLineColor);\n\n\t\t\t\tif(panel.ShowLowLimitLine)\n\t\t\t\t\thLine(svg, lowLimitValue, panel.LowLimitLineColor);\n\n\t\t\t\tgg.append(\"rect\")\t\n\t\t\t\t\t.attr(\"class\", \"michaeldmoore-multistat-panel-bar\")\n\t\t\t\t\t.attr(\"height\", function(d) { \n\t\t\t\t\t\tvar val = scaleAndClipValue(d[valueCol]);\n\t\t\t\t\t\treturn Math.abs(valueScale(baseLineValue) - valueScale(val));\n\t\t\t\t\t\t})\n\t\t\t\t\t.attr(\"width\", labelScale.bandwidth())\n\t\t\t\t\t.attr(\"y\", function(d) { \n\t\t\t\t\t\tvar val = scaleAndClipValue(d[valueCol]);\n\t\t\t\t\t\treturn d3.min([valueScale(val), valueScale(baseLineValue)]); \n\t\t\t\t\t\t})\n\t\t\t\t\t.attr(\"x\", function(d, i) { return labelScale(d[labelCol]);})\n\t\t\t\t\t.attr(\"fill\", function(d) { \n\t\t\t\t\t\tif (recolorHighLimitBar && (d[valueCol] * ScaleFactor > highLimitValue))\n\t\t\t\t\t\t\treturn HighLimitBarColor;\n\t\t\t\t\t\tif (recolorLowLimitBar && (d[valueCol] * ScaleFactor < lowLimitValue))\n\t\t\t\t\t\t\treturn LowLimitBarColor;\n\t\t\t\t\t\treturn (d[valueCol] * ScaleFactor > baseLineValue) ? highBarColor : lowBarColor;\n\t\t\t\t\t\t})\n\t\t\t\t\t.classed(\"highflash\", function(d) { \n\t\t\t\t\t\treturn recolorHighLimitBar && flashHighLimitBar && (d[valueCol] * ScaleFactor > highLimitValue);\n\t\t\t\t\t\t})\n\t\t\t\t\t.classed(\"lowflash\", function(d) { \n\t\t\t\t\t\treturn recolorLowLimitBar && flashLowLimitBar && (d[valueCol] * ScaleFactor < lowLimitValue);\n\t\t\t\t\t\t})\n\t\t\t\t    .on(\"mouseover\", function(d) {\n\t\t\t\t\t\tif (showTooltips)\n\t\t\t\t\t\t\ttooltipShow(d, cols, id);\n\t\t\t\t\t\t})\n\t\t\t\t\t.on(\"mouseout\", function() { \n\t\t\t\t\t\ttooltipHide(id);\n\t\t\t\t\t\t});\n\n\t\t\t\tif (panel.ShowValues && panel.ValuePosition != \"top\") {\n\t\t\t\t\tgg.append(\"text\")\n\t\t\t\t\t.text(function(d) {return (Number(d[valueCol]) * ScaleFactor).toFixed(ValueDecimals);})\n\t\t\t\t\t.attr(\"x\", function(d, i) { return labelScale(d[labelCol]) + (labelScale.bandwidth() / 2); })\n\t\t\t\t\t.attr(\"y\", function(d){\n\t\t\t\t\t\tif (ValuePosition == \"bar base\")\n\t\t\t\t\t\t\treturn valueScale(baseLineValue);\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tvar val = scaleAndClipValue(d[valueCol]);\n\t\t\t\t\t\t\treturn valueScale(val);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.attr(\"font-family\", \"sans-serif\")\n\t\t\t\t\t.attr(\"font-size\", panel.ValueFontSize)\n\t\t\t\t\t.attr(\"fill\", panel.ValueColor)\n\t\t\t\t\t.attr(\"text-anchor\", \"middle\")\n\t\t\t\t\t.attr(\"dominant-baseline\", function(d){\n\t\t\t\t\t\tif (ValuePosition == \"bar base\")\n\t\t\t\t\t\t\treturn (d[valueCol] * ScaleFactor > baseLineValue) ? \"text-after-edge\" : \"text-before-edge\";\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\treturn (d[valueCol] * ScaleFactor > baseLineValue) ? \"text-before-edge\" : \"text-after-edge\";\n\t\t\t\t\t});\n\t\t\t\t}\n\n\n\t\t\t\tif (lowSideMargin > 0) {\t\n\t\t\t\t\tlet gg = svg\n\t\t\t\t\t\t.append(\"g\")\n\t\t\t\t\t\t.attr('transform', 'translate(' + (left + lowSideMargin) + ', 0)')\n\t\t\t\t\t\t.classed('michaeldmoore-multistat-panel-valueaxis', true)\n\t\t\t\t\t\t.call(d3.axisLeft(valueScale).tickSizeInner(5).tickSizeOuter(10).ticks(5));\n\t\t\t\t\tgg.selectAll('.tick text').attr('fill', panel.LowAxisColor);\n\t\t\t\t\tgg.selectAll('.tick line').attr('stroke', panel.LowAxisColor);\n\t\t\t\t\tgg.selectAll('path.domain').attr('stroke', panel.LowAxisColor);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (highSideMargin > 0) {\t\n\t\t\t\t\tlet gg = svg\n\t\t\t\t\t\t.append(\"g\")\n\t\t\t\t\t\t.attr('transform', 'translate(' + (left + w - highSideMargin) + ', 0)')\n\t\t\t\t\t\t.classed('michaeldmoore-multistat-panel-valueaxis', true)\n\t\t\t\t\t\t.call(d3.axisRight(valueScale).tickSizeInner(5).tickSizeOuter(10).ticks(5));\n\t\t\t\t\tgg.selectAll('.tick text').attr('fill', panel.HighAxisColor);\n\t\t\t\t\tgg.selectAll('.tick line').attr('stroke', panel.HighAxisColor);\n\t\t\t\t\tgg.selectAll('path.domain').attr('stroke', panel.HighAxisColor);\n\t\t\t\t}\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tlet groupNameOffset = this.panel.ShowGroupLabels ? Number(this.panel.GroupLabelFontSize.replace('%','')) * 0.15 : 0;\n\t\t\t\t\n\t\t\t\tif (this.groupedRows != null){\n\t\t\t\t\tlet gcols = (GroupCols <= 0 || GroupCols > this.groupedRows.length) ? this.groupedRows.length : GroupCols;\n\t\t\t\t\tlet dw = ((w + GroupGap) / gcols);\n\n\t\t\t\t\t// figure out the max data points in each column of groups...\n\t\t\t\t\tvar pointsPerCol = [];\n\t\t\t\t\tfor(let i = 0; i < gcols; i++)\n\t\t\t\t\t\tpointsPerCol.push(0);\n\t\t\t\t\tfor(let i = 0; i < this.groupedRows.length; i++)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet cc = i % gcols;\n\t\t\t\t\t\tlet u = this.groupedRows[i].values.length;\n\t\t\t\t\t\tif (pointsPerCol[cc] < u)\n\t\t\t\t\t\t\tpointsPerCol[cc] = u;\n\t\t\t\t\t}\n\n\t\t\t\t\tlet totalPoints = 0;\n\t\t\t\t\tfor(let i = 0; i < pointsPerCol.length; i++)\n\t\t\t\t\t\ttotalPoints += pointsPerCol[i];\n\t\t\t\t\t\n\t\t\t\t\tvar colOverheadWidth = this.panel.LowSideMargin + this.panel.HighSideMargin;\n\t\t\t\t\tvar colWidth = (w - (pointsPerCol.length * colOverheadWidth)) / totalPoints;\t\t\t\t\t\n\n\t\t\t\t\tlet numRows = Math.ceil(this.groupedRows.length / gcols);\n\t\t\t\t\tlet dh = h / numRows;\n\t\t\t\t\tlet hh = dh;\n\t\t\t\t\tfor (let rr = 0; rr < numRows; rr++)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet ww = 0;\n\t\t\t\t\t\tfor (let cc = 0; cc < gcols; cc++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlet nn = pointsPerCol[cc];\n\n\t\t\t\t\t\t\tlet ii = cc + (rr * gcols);\n\t\t\t\t\t\t\tif (ii < this.groupedRows.length)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tplotGroupVertical(this.panel, this.svg, this.groupedRows[ii].values, nn, this.groupedRows[ii].key, groupNameOffset, \n\t\t\t\t\t\t\t\t\tww, dw - GroupGap, hh - dh, dh);\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tww += dw;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\thh += dh;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tplotGroupVertical(this.panel, this.svg, this.rows, this.rows.length, '', 0, 0, w, 0, h);\n\t\t\t\t}\t\n\t\t\t}\n\n\t\t\t\t\t\t\n\t\t\tvar pulseHigh = function(svg) {\n\t\t\t\tvar highFlashRects = svg.selectAll(\"rect.michaeldmoore-multistat-panel-bar.highflash\");\n\t\t\t\t\n\t\t\t\tif ($.isNumeric(HighLimitBarFlashTimeout) && highFlashRects._groups.length > 0 && highFlashRects._groups[0].length > 0) {\n\t\t\t\t\thighFlashRects\n\t\t\t\t\t.transition()\n\t\t\t\t\t.on(\"start\", function highRepeat() {\n\t\t\t\t\t\td3.active(this)\n\t\t\t\t\t\t\t.style(\"fill\", HighLimitBarFlashColor)\n\t\t\t\t\t\t\t.duration(HighLimitBarFlashTimeout)\n\t\t\t\t\t\t\t.transition()\n\t\t\t\t\t\t\t.style(\"fill\", HighLimitBarColor)\n\t\t\t\t\t\t\t.duration(HighLimitBarFlashTimeout)\n\t\t\t\t\t\t\t.transition()\n\t\t\t\t\t\t\t.on(\"start\", highRepeat);\n\t\t\t\t\t  });\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tvar pulseLow = function(svg) {\n\t\t\t\tvar lowFlashRects = svg.selectAll(\"rect.michaeldmoore-multistat-panel-bar.lowflash\");\n\t\t\t\tif ($.isNumeric(LowLimitBarFlashTimeout) && lowFlashRects._groups.length > 0 && lowFlashRects._groups[0].length > 0) {\n\t\t\t\t\tlowFlashRects\n\t\t\t\t\t.transition()\n\t\t\t\t\t.on(\"start\", function lowRepeat() {\n\t\t\t\t\t\td3.active(this)\n\t\t\t\t\t\t\t.style(\"fill\", LowLimitBarFlashColor)\n\t\t\t\t\t\t\t.duration(LowLimitBarFlashTimeout)\n\t\t\t\t\t\t\t.transition()\n\t\t\t\t\t\t\t.style(\"fill\", LowLimitBarColor)\n\t\t\t\t\t\t\t.duration(LowLimitBarFlashTimeout)\n\t\t\t\t\t\t\t.transition()\n\t\t\t\t\t\t\t.on(\"start\", lowRepeat);\n\t\t\t\t\t  });\n\t\t\t\t}\n\t\t\t};\n\t\t\t\n\n\t\t\tpulseHigh(this.svg);\n\t\t\tpulseLow(this.svg);\n\t\t}\n\t\telse\n\t\t\tthis.displayStatusMessage(\"No data\");\n\t\t\t\t\t\t\n        this.ctrl.renderingCompleted();\n    }\n\n    onConfigChanged() {\n        this.refresh();\n    }\n\n    link(scope, elem, attrs, ctrl) {\n        this.ctrl = ctrl;\n        this.elem = elem.find('.panel-content');\n    }\n}\n\nMultistatPanelCtrl.templateUrl = 'module.html';\n\nexport { MultistatPanelCtrl as PanelCtrl };\n\n"]}